type: postgresql
mode: standalone
version:
  postgresql: "16"

nameOverride: immich

cluster:
  instances: 1
  imageName: ghcr.io/tensorchord/cloudnative-vectorchord:16.10-0.5.3
  storage:
    storageClass: ssd-ha-cnpg
    size: 10Gi
  walStorage:
    enabled: true
    storageClass: ssd-ha-cnpg
    size: 64Gi
  postgresql:
    shared_preload_libraries:
      - vchord.so
  postgresUID: 26
  postgresGID: 999
  monitoring:
    enabled: true

backups:
  enabled: false
  endpointURL: "http://ssd-ha-hl.object-storage.svc:9000"
  provider: s3
  data:
    encryption: ''
  wal:
    encryption: ''
  secret:
    create: false
    name: immich-s3-creds
  s3:
    bucket: immich-postgresql-backup
    region: ap-northeast-2
  scheduledBackups:
    - name: daily-backup # Daily at midnight
      schedule: "0 0 0 * * *" # Daily at midnight
      backupOwnerReference: self
  retentionPolicy: "30d"
